{"version":3,"sources":["utils/dom.ts","utils/utils.ts","utils/formatters.ts","core/check.ts","utils/path.ts","pages/Check.tsx","content/instructions.md","pages/Instructions.tsx","utils/react.ts","utils/snarkdown.ts","Routes.tsx","App.tsx","index.tsx"],"names":["renderAnchors","el","defaultVal","slugs","Proxy","Object","create","get","target","key","querySelectorAll","heading","textContent","slug","toLowerCase","replace","regex","trim","x","id","filter","Boolean","join","classList","add","check","html","domainBlacklist","violations","fragment","temp","document","createElement","innerHTML","content","htmlToFragment","protocolMatcher","matchers","map","domain","protocol","match","segments","split","hostname","length","pattern","matchPattern","endsWith","slice","assign","links","leafNodes","childNodes","nodeType","Node","TEXT_NODE","link","url","href","text","parent","parentElement","m","find","push","context","leafNode","domains","RegExp","joinPath","process","flat","readFile","file","Promise","res","reader","FileReader","onload","e","result","readAsArrayBuffer","init","Check","defaultValues","useMemo","JSON","parse","localStorage","getItem","useForm","register","handleSubmit","listId","useState","list","setList","useEffect","fetch","then","a","headers","setViolations","loading","setLoading","changeHandler","useCallback","form","setItem","stringify","k","v","undefined","submitHandler","files","arrayBuffer","mammoth","convertToHtml","value","onSubmit","onChange","className","type","name","ref","i","dangerouslySetInnerHTML","__html","Array","isArray","Instructions","callback","setHtml","history","useHistory","instructionsMdUrl","cache","l","some","ch","startsWith","test","_snarkdown","getAttribute","setAttribute","prependPublicUrlToRelativeLinks","addEventListener","nodeName","preventDefault","window","location","origin","open","contains","hash","scrollIntoView","handleLinks","setTimeout","matchedEl","pipe","decodeURIComponent","CSS","escape","querySelector","scrollHashIntoView","parentEl","observer","MutationObserver","disconnect","observe","childList","Routes","exact","path","App","basename","activeClassName","to","ts","console","info","Date","Number","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.28a9b05f.chunk.js","sourcesContent":["import { useHistory } from 'react-router-dom'\nimport { pipe } from 'fp-ts/function'\nimport { slugify } from './formatters'\nimport { hashWithDefault } from './utils'\n\nexport const renderAnchors = (el: HTMLElement) => {\n\tconst slugs = hashWithDefault(0)\n\n\tfor (const heading of el.querySelectorAll(\n\t\t'h2, h3, h4, h5, h6, .anchored',\n\t)) {\n\t\tif (heading.textContent) {\n\t\t\tconst slug = slugify(heading.textContent) || 'heading'\n\n\t\t\tconst x = ++slugs[slug]\n\n\t\t\theading.id = [slug, x > 1 && x].filter(Boolean).join('-')\n\t\t\theading.classList.add('anchored')\n\t\t}\n\t}\n}\n\nexport const prependPublicUrlToRelativeLinks = (el: HTMLElement) => {\n\tfor (const link of el.querySelectorAll('a')) {\n\t\tconst href = link.getAttribute('href')\n\n\t\tif (href?.startsWith('/')) {\n\t\t\tlink.setAttribute('href', process.env.PUBLIC_URL + href)\n\t\t}\n\t}\n}\n\nexport const handleLinks = (\n\tel: HTMLElement,\n\thistory: ReturnType<typeof useHistory>,\n) => {\n\tel.addEventListener('click', (e) => {\n\t\tconst target = e.target as HTMLAnchorElement\n\t\tconst href = target.getAttribute('href')\n\n\t\tif (target.nodeName === 'A' && href) {\n\t\t\te.preventDefault()\n\n\t\t\tif (\n\t\t\t\thref.startsWith('http') &&\n\t\t\t\t!href.startsWith(window.location.origin)\n\t\t\t) {\n\t\t\t\twindow.open(href, '_blank', 'noopener noreferrer')\n\t\t\t} else {\n\t\t\t\thistory.push(href.slice(process.env.PUBLIC_URL.length))\n\t\t\t}\n\t\t} else if (target.classList.contains('anchored')) {\n\t\t\twindow.location.hash = target.id\n\t\t\ttarget.scrollIntoView(true)\n\t\t}\n\t})\n}\n\nexport const scrollHashIntoView = (el: HTMLElement) => {\n\tif (window.location.hash) {\n\t\tsetTimeout(() => {\n\t\t\tconst matchedEl = pipe(\n\t\t\t\twindow.location.hash.slice(1),\n\t\t\t\tdecodeURIComponent,\n\t\t\t\tCSS.escape,\n\t\t\t\t(id) => el.querySelector(`#${id}`),\n\t\t\t)\n\n\t\t\tmatchedEl?.scrollIntoView(true)\n\t\t\t// 100ms to counteract browser position retaining\n\t\t}, 100)\n\t}\n}\n\nexport const htmlToFragment = (html: string) => {\n\tconst temp = document.createElement('template')\n\ttemp.innerHTML = html\n\n\treturn temp.content\n}\n","export const hashWithDefault = <T>(defaultVal: T) =>\n\tnew Proxy(Object.create(null) as Record<string, T>, {\n\t\tget(target, key: string) {\n\t\t\treturn key in target ? target[key] : defaultVal\n\t\t},\n\t})\n","import { regex } from 'fancy-regex'\n\nexport const slugify = (str: string) =>\n\tstr\n\t\t.toLowerCase()\n\t\t.replace(\n\t\t\tregex('gu')`[\n\t\t\t\t^\n\t\t\t\t\\p{Letter}\n\t\t\t\t\\p{Mark}\n\t\t\t\t\\p{Number}\n\t\t\t]+`,\n\t\t\t' ',\n\t\t)\n\t\t.trim()\n\t\t.replace(/\\s+/g, '-')\n\nexport const filenameify = (date: Date) =>\n\tdate.toISOString().replace(/:/g, '_').slice(0, 19) + 'Z'\n","import { matchPattern } from 'browser-extension-url-match'\nimport { htmlToFragment } from '../utils/dom'\n\nexport type Violation = {\n\turl: string\n\ttext: string\n\tdomain: string\n\tpattern: string\n\tcontext: string\n}\n\nexport const check = (html: string, domainBlacklist: string[]): Violation[] => {\n\tconst violations: Violation[] = []\n\tconst fragment = htmlToFragment(html)\n\n\tconst anyProtocol = '*://'\n\tconst protocolMatcher = /^\\w+:\\/{2,3}/\n\n\tconst matchers = domainBlacklist.map((domain) => {\n\t\tconst protocol = domain.match(protocolMatcher)?.[0] ?? anyProtocol\n\n\t\tconst segments = domain.replace(protocolMatcher, '').split('.')\n\n\t\tconst hostname = (\n\t\t\tsegments.length === 2 ? ['*', ...segments] : segments\n\t\t).join('.')\n\n\t\tconst pattern = matchPattern(\n\t\t\t`${protocol}${\n\t\t\t\thostname.endsWith('/') ? hostname.slice(0, -1) : hostname\n\t\t\t}/*`,\n\t\t)\n\n\t\treturn Object.assign({ domain }, pattern)\n\t})\n\n\tconst links = fragment.querySelectorAll<HTMLAnchorElement>('a[href]')\n\n\tconst leafNodes = [...fragment.querySelectorAll<HTMLElement>('*')].filter(\n\t\t(x) =>\n\t\t\tx.childNodes.length === 1 &&\n\t\t\tx.childNodes[0].nodeType === Node.TEXT_NODE,\n\t)\n\n\tfor (const link of links) {\n\t\tconst { href: url, textContent: text } = link\n\n\t\tconst parent = link.parentElement ?? link\n\n\t\tfor (const x of parent.querySelectorAll('a[href]')) {\n\t\t\tx.classList[x === link ? 'add' : 'remove']('violation')\n\t\t}\n\n\t\tconst m = matchers.find((m) => m.match(url))\n\n\t\tif (m) {\n\t\t\tconst { pattern, domain } = m\n\n\t\t\tviolations.push({\n\t\t\t\turl,\n\t\t\t\tcontext: parent.innerHTML,\n\t\t\t\ttext: text!,\n\t\t\t\tpattern,\n\t\t\t\tdomain,\n\t\t\t})\n\t\t}\n\t}\n\n\tfor (const leafNode of leafNodes) {\n\t\tconst text = leafNode.textContent!\n\n\t\tconst parent = leafNode.parentElement ?? leafNode\n\n\t\tconst domains = text.match(/[a-z0-9-]+(\\.[a-z0-9]+)+/gi) ?? []\n\n\t\tfor (const domain of domains) {\n\t\t\tconst m = matchers.find((m) => m.match(`https://${domain}`))\n\n\t\t\tif (m) {\n\t\t\t\tconst { pattern, domain } = m\n\n\t\t\t\tconst context = parent.innerHTML.replace(\n\t\t\t\t\tnew RegExp(domain.replace(/\\./g, '\\\\.'), 'i'),\n\t\t\t\t\t`<span class=\"violation\">${domain}</span>`,\n\t\t\t\t)\n\n\t\t\t\tviolations.push({\n\t\t\t\t\turl: domain,\n\t\t\t\t\tcontext,\n\t\t\t\t\ttext: text!,\n\t\t\t\t\tpattern,\n\t\t\t\t\tdomain,\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\t}\n\n\treturn violations\n}\n","import { join } from 'path'\n\nexport const joinPath = (...segments: string[]) =>\n\tjoin(process.env.PUBLIC_URL, ...segments.flat())\n","import { FC, useCallback, useEffect, useMemo, useState } from 'react'\nimport { useForm } from 'react-hook-form'\nimport { check, Violation } from '../core/check'\nimport { joinPath } from '../utils/path'\nimport mammoth from 'mammoth'\n\nexport const readFile = (file: File) =>\n\tnew Promise<ArrayBuffer>((res) => {\n\t\tconst reader = new FileReader()\n\n\t\treader.onload = (e) => res(e.target!.result as ArrayBuffer)\n\n\t\treader.readAsArrayBuffer(file)\n\t})\n\ntype FormVals = {\n\tfiles?: FileList\n}\n\nconst init: FormVals = {}\n\nexport const Check: FC = () => {\n\tconst defaultValues: FormVals = useMemo(\n\t\t() => JSON.parse(localStorage.getItem('checkerForm') ?? 'null') ?? init,\n\t\t[],\n\t)\n\n\tconst { register, handleSubmit } = useForm<FormVals>({\n\t\tdefaultValues,\n\t})\n\n\tconst listId = 'list'\n\n\tconst [list, setList] = useState<string[]>([])\n\n\tuseEffect(() => {\n\t\tif (listId) {\n\t\t\tfetch(joinPath('lists', `${listId}.txt`)).then(async (res) => {\n\t\t\t\tif (\n\t\t\t\t\tres.headers.get('content-type')?.split(';')[0].trim() !==\n\t\t\t\t\t'text/plain'\n\t\t\t\t) {\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tconst list = await res.text()\n\n\t\t\t\tsetList(list.split('\\n').filter(Boolean))\n\t\t\t})\n\t\t}\n\t}, [listId])\n\n\tconst [violations, setViolations] = useState<Violation[] | null>(null)\n\tconst [loading, setLoading] = useState(false)\n\n\tconst changeHandler = useCallback((form: FormVals) => {\n\t\tlocalStorage.setItem(\n\t\t\t'checkerForm',\n\t\t\tJSON.stringify(form, (k, v) =>\n\t\t\t\t(k as keyof FormVals) === 'files' ? undefined : v,\n\t\t\t),\n\t\t)\n\t}, [])\n\n\tconst submitHandler = useCallback(\n\t\tasync (form: FormVals) => {\n\t\t\tconst { files } = form\n\n\t\t\tsetViolations(null)\n\n\t\t\tif (!files?.length) {\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tsetLoading(true)\n\n\t\t\tconst file = files[0]\n\t\t\tconst arrayBuffer = await readFile(file)\n\n\t\t\tconst result = await mammoth.convertToHtml({ arrayBuffer })\n\n\t\t\tsetViolations(check(result.value, list))\n\n\t\t\tsetLoading(false)\n\t\t},\n\t\t[list],\n\t)\n\n\treturn !list.length ? (\n\t\t<>\n\t\t\t<div className='spaced'>Loading...</div>\n\t\t</>\n\t) : (\n\t\t<form\n\t\t\tonSubmit={handleSubmit(submitHandler)}\n\t\t\tonChange={handleSubmit(changeHandler)}\n\t\t>\n\t\t\t<h1>Check</h1>\n\t\t\t<div className='spaced'>\n\t\t\t\t<label>\n\t\t\t\t\tUpload file (DOCX)\n\t\t\t\t\t<input\n\t\t\t\t\t\tonChange={handleSubmit(submitHandler)}\n\t\t\t\t\t\ttype='file'\n\t\t\t\t\t\tname='files'\n\t\t\t\t\t\tref={register}\n\t\t\t\t\t/>\n\t\t\t\t</label>\n\t\t\t</div>\n\t\t\t{/* <div className='spaced'>\n\t\t\t\t<button type='submit'>Check</button>\n\t\t\t</div> */}\n\n\t\t\t<hr />\n\n\t\t\t<output>\n\t\t\t\t{violations?.length ? (\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t{violations.map((x, i) => (\n\t\t\t\t\t\t\t<li key={i}>\n\t\t\t\t\t\t\t\t<p>\n\t\t\t\t\t\t\t\t\tMatched blacklisted domain\n\t\t\t\t\t\t\t\t\t<code>{x.domain}</code>. Context:\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<blockquote\n\t\t\t\t\t\t\t\t\tclassName='violation-context'\n\t\t\t\t\t\t\t\t\tdangerouslySetInnerHTML={{\n\t\t\t\t\t\t\t\t\t\t__html: x.context,\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ul>\n\t\t\t\t) : Array.isArray(violations) ? (\n\t\t\t\t\t<>No blacklisted domains found 😄</>\n\t\t\t\t) : loading ? (\n\t\t\t\t\t<>Checking...</>\n\t\t\t\t) : (\n\t\t\t\t\t<>No file selected.</>\n\t\t\t\t)}\n\t\t\t</output>\n\t\t</form>\n\t)\n}\n","export default __webpack_public_path__ + \"static/media/instructions.a708fafa.md\";","import { FC, useEffect, useState } from 'react'\nimport { useHistory } from 'react-router-dom'\nimport instructionsMdUrl from '../content/instructions.md'\nimport {\n\thandleLinks,\n\tprependPublicUrlToRelativeLinks,\n\trenderAnchors,\n\tscrollHashIntoView,\n} from '../utils/dom'\nimport { onHtmlRender } from '../utils/react'\nimport { snarkdown } from '../utils/snarkdown'\n\nexport const Instructions: FC = () => {\n\tconst [html, setHtml] = useState('')\n\n\tconst history = useHistory()\n\n\tuseEffect(() => {\n\t\tfetch(instructionsMdUrl, { cache: 'force-cache' }).then(async (res) => {\n\t\t\tconst content = await res.text()\n\n\t\t\tconst html = snarkdown(content)\n\n\t\t\tsetHtml(html)\n\t\t})\n\t}, [])\n\n\treturn (\n\t\t<div\n\t\t\tref={onHtmlRender((el) => {\n\t\t\t\t// setup\n\t\t\t\trenderAnchors(el)\n\t\t\t\tprependPublicUrlToRelativeLinks(el)\n\t\t\t\thandleLinks(el, history)\n\n\t\t\t\t// effects\n\t\t\t\tscrollHashIntoView(el)\n\t\t\t})}\n\t\t\tdangerouslySetInnerHTML={{ __html: html }}\n\t\t/>\n\t)\n}\n","export const onHtmlRender =\n\t(callback: (parentEl: HTMLElement) => void) =>\n\t(parentEl: HTMLElement | null) => {\n\t\tif (!parentEl) return\n\n\t\tconst observer = new MutationObserver((m) => {\n\t\t\tcallback(parentEl)\n\n\t\t\tobserver.disconnect()\n\t\t})\n\n\t\tobserver.observe(parentEl, { childList: true })\n\t}\n","import { default as _snarkdown } from 'snarkdown'\n\nexport const snarkdown = (md: string) => {\n\tconst html = md\n\t\t.split(/((?<=^|\\n)```\\r?\\n[\\s\\S]*?\\r?\\n```)/)\n\t\t.map((m, i) =>\n\t\t\ti % 2\n\t\t\t\t? `<pre><code>${m\n\t\t\t\t\t\t.split(/\\r?\\n/)\n\t\t\t\t\t\t.slice(1, -1)\n\t\t\t\t\t\t.join('\\n')}</pre></code>`\n\t\t\t\t: m\n\t\t\t\t\t\t.split(/(?:\\r?\\n){2,}/)\n\t\t\t\t\t\t.map((l) => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t[' ', '\\t', '#', '-', '*', '`', '~'].some(\n\t\t\t\t\t\t\t\t\t(ch) => l.startsWith(ch),\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\treturn /^\\s*-{3,}\\s*$/.test(l)\n\t\t\t\t\t\t\t\t\t? `<hr>`\n\t\t\t\t\t\t\t\t\t: _snarkdown(l)\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn `<p>${_snarkdown(l)}</p>`\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.join(''),\n\t\t)\n\t\t.join('')\n\t\t.replace(/<p><\\/p>/g, '')\n\n\treturn html\n}\n","import { FC } from 'react'\nimport { Check } from './pages/Check'\nimport { Switch, Route } from 'react-router-dom'\nimport { Instructions } from './pages/Instructions'\n\nexport const Routes: FC = () => {\n\treturn (\n\t\t<Switch>\n\t\t\t<Route exact path='/'>\n\t\t\t\t<Check />\n\t\t\t</Route>\n\t\t\t<Route path='/instructions'>\n\t\t\t\t<Instructions />\n\t\t\t</Route>\n\t\t</Switch>\n\t)\n}\n","import { FC } from 'react'\nimport { BrowserRouter as Router, NavLink } from 'react-router-dom'\nimport { Routes } from './Routes'\n\nexport const App: FC = () => {\n\treturn (\n\t\t<>\n\t\t\t<Router basename={process.env.PUBLIC_URL}>\n\t\t\t\t<nav className='tabs'>\n\t\t\t\t\t<NavLink exact activeClassName='active' to='/'>\n\t\t\t\t\t\tCheck\n\t\t\t\t\t</NavLink>\n\t\t\t\t\t<NavLink activeClassName='active' to='/instructions'>\n\t\t\t\t\t\tInstructions\n\t\t\t\t\t</NavLink>\n\t\t\t\t</nav>\n\t\t\t\t<main className='container'>\n\t\t\t\t\t<Routes />\n\t\t\t\t</main>\n\t\t\t</Router>\n\t\t</>\n\t)\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport 'chota/dist/chota.css' // can't use .min.css due to CRA transpiling bug\nimport './styles/index.css'\nimport { App } from './App'\nimport { joinPath } from './utils/path'\n\nfetch(joinPath('build-timestamp.txt')).then(async (res) => {\n\tconst ts = await res.text()\n\n\tconsole.info('App last built', new Date(Number(ts)))\n})\n\nReactDOM.render(\n\t<React.StrictMode>\n\t\t<App />\n\t</React.StrictMode>,\n\tdocument.getElementById('root'),\n)\n"],"sourceRoot":""}